openapi: 3.0.3

info:
  title: HealthScope API
  description: >
    REST API for the WADe project "HealthScope".
    The API aggregates medical condition data from Linked Data sources
    such as Wikidata, WikiDoc, and DBpedia and exposes a normalized JSON model
    suitable for a Web frontend.
  version: "1.0.0"
  contact:
    name: WADe Project Team
  license:
    name: MIT

servers:
  - url: http://localhost:3000/api
    description: Local development server

tags:
  - name: Conditions
    description: Medical condition search and details
  - name: Geo
    description: Geographic and contextual information

paths:

  /conditions/search:
    get:
      tags:
        - Conditions
      summary: Search medical conditions
      description: >
        Performs a case-insensitive search over medical conditions.
        Results are identified by Wikidata Q-IDs and include labels and short descriptions.
      parameters:
        - name: q
          in: query
          required: true
          description: Search string (minimum 2 characters).
          schema:
            type: string
            minLength: 2
            example: hypertension
      responses:
        "200":
          description: List of matching conditions
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/SearchResult"
              example:
                - id: Q95566669
                  label: hypertension
                  description: elevated pressure in a specific organ of the body
                - id: Q7663896
                  label: systolic hypertension
                  description: elevated systolic blood pressure
        "400":
          description: Invalid query
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /conditions/{id}:
    get:
      tags:
        - Conditions
      summary: Get condition details
      description: >
        Returns aggregated information about a medical condition identified by a Wikidata Q-ID.
        The response may include narrative sections, structured lists, and source attribution.
      parameters:
        - name: id
          in: path
          required: true
          description: Wikidata Q-ID (e.g., Q95566669)
          schema:
            type: string
            pattern: "^Q[0-9]+$"
            example: Q95566669
      responses:
        "200":
          description: Condition details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Condition"
              example:
                id: Q95566669
                name: hypertension
                description: elevated pressure in a specific organ of the body
                sections:
                  overview: Hypertension is a major risk factor for cardiovascular disease.
                  symptoms: []
                  riskFactors: []
                  prevention:
                    - Effective measures for the primary prevention of hypertension include lifestyle changes.
                bodySystems: []
                sources:
                  - name: Wikidata
                    url: https://www.wikidata.org/wiki/Q95566669
                  - name: WikiDoc
                    url: https://www.wikidoc.org/index.php/hypertension
        "400":
          description: Invalid Q-ID
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Condition not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /conditions/{id}/geo:
    get:
      tags:
        - Geo
      summary: Get geographic context for a condition
      description: >
        Returns a simplified geographic risk/context proxy for a given condition and country.
        This endpoint is educational and not intended for medical diagnosis.
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            example: Q95566669
        - name: country
          in: query
          required: true
          description: ISO 2-letter country code
          schema:
            type: string
            example: RO
      responses:
        "200":
          description: Geographic context
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GeoContext"
        "400":
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

components:

  schemas:

    SearchResult:
      type: object
      properties:
        id:
          type: string
          description: Wikidata Q-ID
        label:
          type: string
        description:
          type: string
          nullable: true

    Condition:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
          nullable: true
        sections:
          $ref: "#/components/schemas/Sections"
        bodySystems:
          type: array
          items:
            $ref: "#/components/schemas/BodySystem"
        sources:
          type: array
          items:
            $ref: "#/components/schemas/Source"

    Sections:
      type: object
      properties:
        overview:
          type: string
          nullable: true
        symptoms:
          type: array
          items:
            type: string
        riskFactors:
          type: array
          items:
            type: string
        prevention:
          type: array
          items:
            type: string

    BodySystem:
      type: object
      properties:
        id:
          type: string
        label:
          type: string

    Source:
      type: object
      properties:
        name:
          type: string
        url:
          type: string
          nullable: true

    GeoContext:
      type: object
      properties:
        id:
          type: string
        country:
          type: string
        value:
          type: number
        valueLabel:
          type: string
        factors:
          type: array
          items:
            type: string
        sources:
          type: array
          items:
            $ref: "#/components/schemas/Source"

    Error:
      type: object
      properties:
        statusCode:
          type: integer
        message:
          type: string
